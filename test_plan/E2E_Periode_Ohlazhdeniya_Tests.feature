Feature: End-to-End: Оформление кредита
  Scenario: End-to-End: Оформление кредита (TC01)
    Given 1. Авторизоваться как клиент в ДБО
    When 2. Перейти к оформлению кредита
    And 3. Заполнить анкету и подтвердить заявку
    And 4. Проверить, что кредит оформлен и задан период охлаждения (отображается дата/время окончания)
    Then Кредит успешно оформлен, параметр периода охлаждения установлен и отображается


Feature: End-to-End: Отображение периода в ДБО
  Scenario: End-to-End: Отображение периода в ДБО (TC02)
    Given 1. Авторизоваться в ДБО
    When 2. Перейти в раздел 'Кредиты'
    And 3. Открыть карточку нового кредита
    And 4. Проверить блок информации о периоде охлаждения
    Then Отображается срок действия периода (дата и время окончания)


Feature: End-to-End: Подача заявления в срок
  Scenario: End-to-End: Подача заявления в срок (TC03)
    Given 1. Авторизоваться в ДБО в течение 24 часов после оформления кредита
    When 2. Нажать 'Отказаться от кредита'
    And 3. Подтвердить отказ (при необходимости — подписать ЭЦП)
    And 4. Проверить статус заявления
    Then Заявление успешно подано, отображается статус 'Принято'


Feature: End-to-End: Подача после срока
  Scenario: End-to-End: Подача после срока (TC04)
    Given 1. Авторизоваться в ДБО спустя срок периода охлаждения (например, через 49 часов)
    When 2. Перейти в карточку кредита
    And 3. Попытаться подать заявление
    Then Выводится сообщение: 'Период охлаждения истёк, отказ невозможен'


Feature: End-to-End: Дубликатное заявление
  Scenario: End-to-End: Дубликатное заявление (TC05)
    Given 1. Подать первое заявление на отказ
    When 2. Попробовать повторно подать заявление по тому же кредиту
    Then Система отклоняет повторную попытку: 'Заявление уже подано'


Feature: End-to-End: Полный возврат суммы
  Scenario: End-to-End: Полный возврат суммы (TC06)
    Given 1. После подачи заявления перевести точную сумму основного долга на указанные реквизиты
    When 2. Дождаться зачисления и проверки системой
    And 3. Проверить статус договора
    Then Кредит завершён, начисления отменены, статус договора: 'Аннулирован'


Feature: End-to-End: Частичный возврат
  Scenario: End-to-End: Частичный возврат (TC07)
    Given 1. Перевести только часть суммы основного долга
    When 2. Проверить статус заявления через 1 час
    Then Система уведомляет о неполном возврате, отказ не завершён


Feature: End-to-End: Сторнирование начислений
  Scenario: End-to-End: Сторнирование начислений (TC08)
    Given 1. Выполнить возврат всей суммы долга
    When 2. Открыть детали по кредиту в ДБО
    And 3. Убедиться в отсутствии начислений (проценты, комиссии)
    Then Всё сторнировано, остаток задолженности: 0 ₽


Feature: End-to-End: Подача через офис
  Scenario: End-to-End: Подача через офис (TC09)
    Given 1. Обратиться в офис в течение срока периода охлаждения
    When 2. Сотрудник находит кредит клиента
    And 3. Заполняет форму отказа от кредита
    And 4. Подтверждает заявление в системе
    Then Заявление отображается в системе с каналом подачи: 'Офис'


Feature: End-to-End: Логирование отказа
  Scenario: End-to-End: Логирование отказа (TC10)
    Given 1. Завершить отказ клиента от кредита
    When 2. Перейти в модуль логирования (лог просмотра событий)
    And 3. Найти запись по дате и клиенту
    Then Запись в журнале есть: заявление, канал, дата, сумма


Feature: End-to-End: Формирование отчётности
  Scenario: End-to-End: Формирование отчётности (TC11)
    Given 1. Завершить 3–5 отказов от кредита через ДБО и офис
    When 2. Запустить процесс генерации отчета за день
    And 3. Проверить, что все события попали в выгрузку (например, Excel или JSON-файл)
    Then Отчёт содержит все проведённые действия по отказам
